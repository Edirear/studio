<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Edirear Studio</title>

<!-- Google Identity & API -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://apis.google.com/js/api.js"></script>

<!-- Chart.js for graphs -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
* {
  margin: 0; padding: 0; box-sizing: border-box;
  font-family: 'Segoe UI', sans-serif;
}
body {
  background-color: #000;
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}
header {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 20px;
  background: #111;
  border-bottom: 1px solid #222;
}
.logo {
  display: flex; align-items: center; gap: 10px;
}
.player-icon {
  width: 30px; height: 30px; fill: #00ff7f;
}
.title {
  color: #00ff7f;
  font-size: 1.4em;
  font-weight: bold;
}
.menu {
  cursor: pointer;
  font-size: 24px;
}
#menuOptions {
  display: none;
  position: absolute;
  top: 60px;
  right: 20px;
  background: #111;
  border: 1px solid #222;
  border-radius: 8px;
  overflow: hidden;
}
#menuOptions a {
  display: block;
  color: #00ff7f;
  padding: 10px 15px;
  text-decoration: none;
  transition: background 0.2s;
}
#menuOptions a:hover {
  background: #00ff7f;
  color: #000;
}
.content {
  margin-top: 50px;
  text-align: center;
  width: 90%;
  max-width: 1200px;
}
button {
  background: #00ff7f;
  border: none;
  padding: 12px 25px;
  color: #000;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.3s;
}
button:hover { background: #00cc66; }
.stats {
  margin-top: 20px;
  background: #111;
  padding: 15px;
  border-radius: 8px;
  width: 100%;
  text-align: left;
}
.stat-line {
  margin: 5px 0;
  border-bottom: 1px solid #222;
  padding-bottom: 5px;
}
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 20px;
}
.stat-card {
  background: #1a1a1a;
  padding: 15px;
  border-radius: 8px;
  border-left: 4px solid #00ff7f;
}
.stat-card h4 {
  color: #00ff7f;
  margin-bottom: 10px;
}
.stat-value {
  font-size: 1.5em;
  font-weight: bold;
}
.charts-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin-top: 30px;
}
.chart-card {
  background: #1a1a1a;
  padding: 15px;
  border-radius: 8px;
}
.chart-card h4 {
  color: #00ff7f;
  margin-bottom: 15px;
  text-align: center;
}
.upload-form {
  margin-top: 20px;
  background: #111;
  padding: 20px;
  border-radius: 8px;
  width: 100%;
  max-width: 600px;
  display: none;
}
.upload-form h3 {
  color: #00ff7f;
  margin-bottom: 20px;
  text-align: center;
}
.form-group {
  margin-bottom: 15px;
  text-align: left;
}
.upload-form label {
  color: #00ff7f;
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}
.upload-form input, .upload-form textarea, .upload-form select {
  width: 100%;
  padding: 10px;
  border: none;
  border-radius: 6px;
  background: #222;
  color: #fff;
}
.upload-form textarea {
  resize: vertical;
  min-height: 100px;
}
.file-input-container {
  position: relative;
  overflow: hidden;
  display: inline-block;
  width: 100%;
}
.file-input-container input[type=file] {
  position: absolute;
  left: 0;
  top: 0;
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.file-input-label {
  display: block;
  padding: 10px;
  background: #222;
  border-radius: 6px;
  text-align: center;
  cursor: pointer;
  transition: background 0.3s;
}
.file-input-label:hover {
  background: #333;
}
.file-name {
  margin-top: 5px;
  font-size: 0.9em;
  color: #aaa;
}
.form-buttons {
  display: flex;
  gap: 10px;
  justify-content: flex-end;
  margin-top: 20px;
}
.cancel-btn {
  background: #333;
  color: #fff;
}
.cancel-btn:hover {
  background: #444;
}
</style>
</head>

<body>
<header>
  <div class="logo">
    <svg class="player-icon" viewBox="0 0 64 64">
      <circle cx="32" cy="32" r="30" stroke="#00ff7f" stroke-width="3" fill="none"/>
      <polygon points="26,20 46,32 26,44" fill="#00ff7f"/>
    </svg>
    <span class="title">Edirear Studio</span>
  </div>
  <div class="menu" onclick="toggleMenu()">‚ò∞</div>
  <div id="menuOptions">
    <a href="https://edirear.github.io/home" target="_blank">Home</a>
    <a href="https://edirear.github.io/AVERTISE-ON-EDIREAR" target="_blank">Advertise on Edirear</a>
  </div>
</header>

<div class="content">
  <h2>Welcome to Edirear Studio</h2>
  <p>Sign in with Google to see your YouTube stats and upload videos.</p>
  <br>
  <div id="gSignIn"></div>

  <div class="stats" id="statsSection" style="display:none;">
    <h3>üìä Your Channel Statistics</h3>
    <div id="channelData"></div>
    
    <div class="stats-grid" id="statsGrid"></div>
    
    <div class="charts-container" id="chartsContainer"></div>
    
    <br>
    <button onclick="toggleUploadForm()">Upload Video to YouTube</button>
  </div>

  <div class="upload-form" id="uploadForm">
    <h3>üé¨ Upload a New Video</h3>
    
    <div class="form-group">
      <label for="videoTitle">Title</label>
      <input type="text" id="videoTitle" placeholder="Enter video title">
    </div>
    
    <div class="form-group">
      <label for="videoDescription">Description</label>
      <textarea id="videoDescription" rows="4" placeholder="Enter video description"></textarea>
    </div>
    
    <div class="form-group">
      <label for="videoPrivacy">Privacy</label>
      <select id="videoPrivacy">
        <option value="public">Public</option>
        <option value="unlisted">Unlisted</option>
        <option value="private">Private</option>
      </select>
    </div>
    
    <div class="form-group">
      <label>Choose Video File</label>
      <div class="file-input-container">
        <div class="file-input-label">Select Video File</div>
        <input type="file" id="videoFile" accept="video/*">
      </div>
      <div class="file-name" id="fileName">No file selected</div>
    </div>
    
    <div class="form-buttons">
      <button class="cancel-btn" onclick="toggleUploadForm()">Cancel</button>
      <button onclick="uploadVideo()">Upload Now</button>
    </div>
  </div>
</div>

<script>
const CLIENT_ID = "380562358749-dgepdvs51caf2j64ds0iti3qp06j7k4n.apps.googleusercontent.com";
const API_KEY = "AIzaSyDg_IEUL5EjfG7vtDsaQeyJJ5mmgOkW59M";
const SCOPES = "https://www.googleapis.com/auth/youtube.readonly https://www.googleapis.com/auth/youtube.upload openid email profile";

let tokenClient;
let accessToken = null;

function toggleMenu() {
  const menu = document.getElementById('menuOptions');
  menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
}

function gapiLoad() {
  gapi.load('client', initClient);
}

function initClient() {
  gapi.client.init({
    apiKey: API_KEY,
    discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest"],
  });
}

window.onload = function() {
  tokenClient = google.accounts.oauth2.initTokenClient({
    client_id: CLIENT_ID,
    scope: SCOPES,
    callback: async (tokenResponse) => {
      accessToken = tokenResponse.access_token;
      await loadYouTubeData();
    },
  });

  document.getElementById('gSignIn').innerHTML =
    '<button onclick="signIn()">Sign in with Google</button>';

  // Add file input event listener
  document.getElementById('videoFile').addEventListener('change', function(e) {
    const fileName = e.target.files.length > 0 ? e.target.files[0].name : 'No file selected';
    document.getElementById('fileName').textContent = fileName;
  });

  gapiLoad();
};

function signIn() {
  tokenClient.requestAccessToken();
}

async function loadYouTubeData() {
  document.getElementById("statsSection").style.display = "block";
  try {
    gapi.client.setApiKey(API_KEY);
    const response = await gapi.client.youtube.channels.list({
      part: "snippet,contentDetails,statistics",
      mine: true
    });

    const channel = response.result.items[0];
    const stats = channel.statistics;
    
    // Basic channel info
    const channelHTML = `
      <div class="stat-line"><b>Channel:</b> ${channel.snippet.title}</div>
      <div class="stat-line"><b>Channel ID:</b> ${channel.id}</div>
    `;
    document.getElementById("channelData").innerHTML = channelHTML;
    
    // Stats grid
    const statsGridHTML = `
      <div class="stat-card">
        <h4>Subscribers</h4>
        <div class="stat-value">${parseInt(stats.subscriberCount).toLocaleString()}</div>
      </div>
      <div class="stat-card">
        <h4>Total Views</h4>
        <div class="stat-value">${parseInt(stats.viewCount).toLocaleString()}</div>
      </div>
      <div class="stat-card">
        <h4>Total Videos</h4>
        <div class="stat-value">${parseInt(stats.videoCount).toLocaleString()}</div>
      </div>
      <div class="stat-card">
        <h4>GitHub Views</h4>
        <div class="stat-value">${Math.floor(Math.random()*1000+100).toLocaleString()}</div>
      </div>
    `;
    document.getElementById("statsGrid").innerHTML = statsGridHTML;
    
    // Create charts
    createCharts(stats);
    
  } catch (err) {
    console.error(err);
    alert("Error fetching YouTube data.");
  }
}

function createCharts(stats) {
  const chartsContainer = document.getElementById('chartsContainer');
  
  // Views chart
  const viewsChartHTML = `
    <div class="chart-card">
      <h4>Views Distribution</h4>
      <canvas id="viewsChart"></canvas>
    </div>
  `;
  
  // Engagement chart
  const engagementChartHTML = `
    <div class="chart-card">
      <h4>Engagement Metrics</h4>
      <canvas id="engagementChart"></canvas>
    </div>
  `;
  
  // Growth chart
  const growthChartHTML = `
    <div class="chart-card">
      <h4>Growth Over Time</h4>
      <canvas id="growthChart"></canvas>
    </div>
  `;
  
  chartsContainer.innerHTML = viewsChartHTML + engagementChartHTML + growthChartHTML;
  
  // Generate random data for demonstration
  const randomData = Array.from({length: 6}, () => Math.floor(Math.random() * 100) + 10);
  const randomMonths = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
  
  // Views Chart
  const viewsCtx = document.getElementById('viewsChart').getContext('2d');
  new Chart(viewsCtx, {
    type: 'bar',
    data: {
      labels: randomMonths,
      datasets: [{
        label: 'Monthly Views',
        data: randomData,
        backgroundColor: '#00ff7f',
        borderColor: '#00cc66',
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          labels: {
            color: '#fff'
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#aaa'
          },
          grid: {
            color: '#333'
          }
        },
        x: {
          ticks: {
            color: '#aaa'
          },
          grid: {
            color: '#333'
          }
        }
      }
    }
  });
  
  // Engagement Chart
  const engagementCtx = document.getElementById('engagementChart').getContext('2d');
  new Chart(engagementCtx, {
    type: 'doughnut',
    data: {
      labels: ['Likes', 'Comments', 'Shares'],
      datasets: [{
        data: [65, 20, 15],
        backgroundColor: [
          '#00ff7f',
          '#00cc66',
          '#00994d'
        ],
        borderColor: '#111',
        borderWidth: 2
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: 'bottom',
          labels: {
            color: '#fff',
            padding: 15
          }
        }
      }
    }
  });
  
  // Growth Chart
  const growthCtx = document.getElementById('growthChart').getContext('2d');
  new Chart(growthCtx, {
    type: 'line',
    data: {
      labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
      datasets: [{
        label: 'Subscriber Growth',
        data: [120, 150, 180, 210, 250, 300],
        borderColor: '#00ff7f',
        backgroundColor: 'rgba(0, 255, 127, 0.1)',
        borderWidth: 2,
        fill: true,
        tension: 0.4
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          labels: {
            color: '#fff'
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#aaa'
          },
          grid: {
            color: '#333'
          }
        },
        x: {
          ticks: {
            color: '#aaa'
          },
          grid: {
            color: '#333'
          }
        }
      }
    }
  });
}

function toggleUploadForm() {
  const form = document.getElementById('uploadForm');
  form.style.display = form.style.display === 'block' ? 'none' : 'block';
  
  // Reset form when closing
  if (form.style.display === 'none') {
    document.getElementById('videoTitle').value = '';
    document.getElementById('videoDescription').value = '';
    document.getElementById('videoPrivacy').value = 'public';
    document.getElementById('videoFile').value = '';
    document.getElementById('fileName').textContent = 'No file selected';
  }
}

async function uploadVideo() {
  const title = document.getElementById('videoTitle').value;
  const description = document.getElementById('videoDescription').value;
  const privacy = document.getElementById('videoPrivacy').value;
  const file = document.getElementById('videoFile').files[0];

  if (!file || !title) {
    alert("Please select a video and enter a title.");
    return;
  }

  const metadata = {
    snippet: { title, description },
    status: { privacyStatus: privacy }
  };

  const form = new FormData();
  form.append('snippet', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
  form.append('file', file);

  try {
    const uploadResponse = await fetch('https://www.googleapis.com/upload/youtube/v3/videos?part=snippet,status', {
      method: 'POST',
      headers: { Authorization: 'Bearer ' + accessToken },
      body: form
    });
    const result = await uploadResponse.json();

    if (result.id) {
      alert(`üéØ Video uploaded successfully! Video ID: ${result.id}`);
      toggleUploadForm(); // Close the form after successful upload
    } else {
      alert("‚òÅÔ∏è Upload failed: " + JSON.stringify(result));
    }
  } catch (error) {
    alert("Error uploading video: " + error.message);
  }
}
</script>
</body>
</html>